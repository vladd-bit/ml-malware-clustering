import math
import numpy

from sklearn.ensemble import RandomForestClassifier
from src.config import CPU_COUNT
from src.util import calculate_stats


def random_forest(dataset, dataset_dense, label_numbers, n_clusters):

    random_f = RandomForestClassifier(n_estimators=int(math.log(numpy.shape(dataset)[0])), max_depth=100, random_state=0,
                                      criterion='gini', n_jobs=CPU_COUNT)
    labels = random_f.predict(dataset)

    stats = [calculate_stats(algorithm_type="random_forest", dataset=dataset, dataset_dense=dataset_dense,
                             n_clusters=n_clusters,
                             true_labels=label_numbers,
                             pred_labels=labels)]

    return {'stats': stats, 'predictions': labels}
